
  -- TABLE DELETE --
DROP TABLE CART;
DROP TABLE ORDERS;
DROP TABLE ORDERDETAIL;
DROP TABLE MEMBER;
DROP TABLE PRODUCT;



  -- SEQUENCE RESET --
DROP SEQUENCE CART_SEQ;
DROP SEQUENCE ORDERS_SEQ;
DROP SEQUENCE ORDERDETAIL_SEQ;


  -- SEQUENCE CREATE --
CREATE SEQUENCE CART_SEQ
  MAXVALUE 9999999999
  NOCACHE
  NOCYCLE;
  
CREATE SEQUENCE ORDERS_SEQ
  MAXVALUE 9999999999
  NOCACHE
  NOCYCLE;
  
CREATE SEQUENCE ORDERDETAIL_SEQ
  MAXVALUE 999
  NOCACHE
  NOCYCLE;
  

  -- TABLE CREATE --
CREATE TABLE MEMBER (
  mID VARCHAR2(10) PRIMARY KEY,
  mPW VARCHAR2(10) NOT NULL,
  mNAME VARCHAR2(20) NOT NULL,
  mADDRESS VARCHAR2(255) NOT NULL,
  mTEL VARCHAR2(20) UNIQUE,
  mDATE DATE DEFAULT SYSDATE
  );
  
CREATE TABLE PRODUCT (
  pCODE VARCHAR2(5) PRIMARY KEY,
  pNAME VARCHAR2(20) NOT NULL,
  pPRICE NUMBER(10) CHECK(pPRICE >= 1),
  pINVENTORY NUMBER(5) CHECK(pINVENTORY >= 0)
  );

CREATE TABLE CART (
  cNO NUMBER(10) PRIMARY KEY,
  mID VARCHAR2(10) REFERENCES MEMBER(mID),
  pCODE VARCHAR2(5) REFERENCES PRODUCT(pCODE),
  pNAME VARCHAR2(20) NOT NULL,
  cQTY NUMBER(5) CHECK(cQTY >= 1),
  cCOST NUMBER(10) NOT NULL
  );

CREATE TABLE ORDERS (
  mID VARCHAR2(10) REFERENCES MEMBER(mID),
  oNO NUMBER(10) PRIMARY KEY,
  oDATE DATE DEFAULT SYSDATE,
  oNAME VARCHAR2(20) NOT NULL,
  oADDRESS VARCHAR2(255) NOT NULL,
  oTEL VARCHAR2(20) NOT NULL
 );

CREATE TABLE ORDERDETAIL (
  dNO NUMBER(3) PRIMARY KEY,
  oNO NUMBER(10) NOT NULL,
  pCODE VARCHAR2(5) REFERENCES PRODUCT(pCODE),
  pNAME VARCHAR2(20) NOT NULL,
  cQTY NUMBER(5) CHECK(cQTY >= 1),
  cCOST NUMBER(10)
 );
 
 
  -- DATA INSERT(MEMBER)  --
INSERT INTO MEMBER (mID, mPW, mNAME, mADDRESS, mTEL) VALUES ('abc', 'aaa', '홍길동', '서울시 서대문구 대현동', '010-9999-9999');
INSERT INTO MEMBER (mID, mPW, mNAME, mADDRESS, mTEL) VALUES ('def', 'bbb', '김김동', '경기도 수원시', '010-8888-8888');


  -- DATA INSERT(PRODUCT)  --
INSERT INTO PRODUCT (pCODE, pNAME, pPRICE, pINVENTORY) VALUES ('a1', '맥주', 3000, 0);
INSERT INTO PRODUCT (pCODE, pNAME, pPRICE, pINVENTORY) VALUES ('a2', '마스크', 200, 0);
INSERT INTO PRODUCT (pCODE, pNAME, pPRICE, pINVENTORY) VALUES ('b1', '땅콩', 3000, 0);
INSERT INTO PRODUCT (pCODE, pNAME, pPRICE, pINVENTORY) VALUES ('b2', '오징어', 5000, 0);
INSERT INTO PRODUCT (pCODE, pNAME, pPRICE, pINVENTORY) VALUES ('c1', '소독약', 7000, 0);

  -- DATA UPDATE(INVENTORY 추가)--
UPDATE PRODUCT SET pINVENTORY = 100 WHERE pCODE='a1';
UPDATE PRODUCT SET pINVENTORY = 100 WHERE pCODE='a2';
UPDATE PRODUCT SET pINVENTORY = 100 WHERE pCODE='b1';
UPDATE PRODUCT SET pINVENTORY = 100 WHERE pCODE='b2';
UPDATE PRODUCT SET pINVENTORY = 100 WHERE pCODE='c1';

  -- DATA INPUT TEST --
SELECT * FROM MEMBER;
SELECT * FROM CART;
SELECT * FROM ORDERS;
SELECT * FROM PRODUCT;
SELECT * FROM ORDERDETAIL;

--====================================================================================================================================================================================================--
  -- 홍길동 ORDER --
INSERT INTO ORDERS (mID, oNO, oDATE, oNAME, oADDRESS, oTEL) VALUES ('abc', TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.NEXTVAL, '000')), '23-07-28', '홍길동', '서울 서대문구 대현동', '010-9999-9999');

  -- 홍길동 CART -- 
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'abc', 'a1', '맥주', 3, 9000);
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'abc', 'b1', '땅콩', 1, 3000);

  -- 홍길동 주문상세 --
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'a1', '맥주', 3, 9000);
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'b1', '땅콩', 3, 9000);

  -- INVENTORY UPDATE -- 
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='a1';
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='b1';

  -- CART DROP --


--====================================================================================================================================================================================================--
  -- 김김동 ORDER --
INSERT INTO ORDERS (mID, oNO, oDATE, oNAME, oADDRESS, oTEL) VALUES ('def', TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.NEXTVAL, '000')), '23-07-26', '김김동', '경기도 수원시', '010-8888-8888');

  -- 김김동 CART --
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'def', 'a2', '마스크', 20, 4000);
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'def', 'b2', '오징어', 2, 10000);
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'def', 'c1', '소독약', 1, 7000);  
  
  -- 김길동 주문상세 --
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'a2', '마스크', 20, 4000);
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'b2', '오징어', 3, 9000);
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'c1', '소독약', 3, 9000);

  -- INVENTORY UPDATE -- 
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 20 WHERE pCODE='a2';
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='b2';
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='c1';
--====================================================================================================================================================================================================--  
  -- 홍아빠 ORDER --
INSERT INTO ORDERS (mID, oNO, oDATE, oNAME, oADDRESS, oTEL) VALUES ('abc', TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.NEXTVAL, '000')), '23-07-28', '홍아빠', '제주도 제주시', '010-7777-9999');

  -- 홍아빠 CART --
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'abc', 'a1', '맥주', 2, 6000);
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'abc', 'b1', '땅콩', 1, 3000);
INSERT INTO CART (cNO, mID, pCODE, pNAME, cQTY, cCOST) VALUES (CART_SEQ.NEXTVAL,'abc', 'c1', '소독약', 1, 7000);

  -- 홍아빠 주문상세 --
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'a1', '맥주', 3, 9000);
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'b1', '땅콩', 3, 9000);
INSERT INTO ORDERDETAIL (dNO, oNO, pCODE, pNAME, cQTY ,cCOST) VALUES (ORDERDETAIL_SEQ.NEXTVAL, TO_CHAR(SYSDATE, 'RRMMDD')||TRIM(TO_CHAR(ORDERS_SEQ.CURRVAL, '000')), 'c1', '소독약', 1, 7000);  

  -- INVENTORY UPDATE -- 
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='a1';
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 3 WHERE pCODE='b1';
UPDATE PRODUCT SET pINVENTORY = pINVENTORY - 1 WHERE pCODE='c1';
--====================================================================================================================================================================================================--






